diff -ru openresty-1.11.2.1/bundle/nginx-1.11.2/docs/html/index.html openresty-1.11.2.4/bundle/nginx-1.11.2/docs/html/index.html
--- openresty-1.11.2.1/bundle/nginx-1.11.2/docs/html/index.html	2016-08-25 02:20:57.000000000 +0200
+++ openresty-1.11.2.4/bundle/nginx-1.11.2/docs/html/index.html	2017-07-11 19:36:36.000000000 +0200
@@ -16,7 +16,7 @@
 working. Further configuration is required.</p>

 <p>For online documentation and support please refer to
-<a href="https://openresty.org/">openresty.org</a>.<br/>
+<a href="https://openresty.org/">openresty.org</a>.<br/></p>

 <p><em>Thank you for flying OpenResty.</em></p>
 </body>
diff -ru openresty-1.11.2.1/bundle/nginx-1.11.2/src/core/nginx.h openresty-1.11.2.4/bundle/nginx-1.11.2/src/core/nginx.h
--- openresty-1.11.2.1/bundle/nginx-1.11.2/src/core/nginx.h	2016-08-25 02:20:57.000000000 +0200
+++ openresty-1.11.2.4/bundle/nginx-1.11.2/src/core/nginx.h	2017-07-11 19:36:35.000000000 +0200
@@ -11,7 +11,7 @@

 #define nginx_version      1011002
 #define NGINX_VERSION      "1.11.2"
-#define NGINX_VER          "openresty/" NGINX_VERSION ".1"
+#define NGINX_VER          "openresty/" NGINX_VERSION ".4"

 #ifdef NGX_BUILD
 #define NGINX_VER_BUILD    NGINX_VER " (" NGX_BUILD ")"
diff -ru openresty-1.11.2.1/bundle/nginx-1.11.2/src/core/ngx_resolver.c openresty-1.11.2.4/bundle/nginx-1.11.2/src/core/ngx_resolver.c
--- openresty-1.11.2.1/bundle/nginx-1.11.2/src/core/ngx_resolver.c	2016-07-18 04:19:50.000000000 +0200
+++ openresty-1.11.2.4/bundle/nginx-1.11.2/src/core/ngx_resolver.c	2017-07-11 19:36:36.000000000 +0200
@@ -224,14 +224,22 @@
             continue;
         }

-#if (NGX_HAVE_INET6)
         if (ngx_strncmp(names[i].data, "ipv6=", 5) == 0) {

             if (ngx_strcmp(&names[i].data[5], "on") == 0) {
+#if (NGX_HAVE_INET6)
                 r->ipv6 = 1;
+#else
+                ngx_conf_log_error(NGX_LOG_EMERG, cf, 0,
+                                   "no ipv6 support but \"%V\" in resolver",
+                                   &names[i]);
+                return NULL;
+#endif

             } else if (ngx_strcmp(&names[i].data[5], "off") == 0) {
+#if (NGX_HAVE_INET6)
                 r->ipv6 = 0;
+#endif

             } else {
                 ngx_conf_log_error(NGX_LOG_EMERG, cf, 0,
@@ -241,7 +249,6 @@

             continue;
         }
-#endif

         ngx_memzero(&u, sizeof(ngx_url_t));

diff -ru openresty-1.11.2.1/bundle/nginx-1.11.2/src/http/modules/ngx_http_range_filter_module.c openresty-1.11.2.4/bundle/nginx-1.11.2/src/http/modules/ngx_http_range_filter_module.c
--- openresty-1.11.2.1/bundle/nginx-1.11.2/src/http/modules/ngx_http_range_filter_module.c	2016-07-18 04:19:50.000000000 +0200
+++ openresty-1.11.2.4/bundle/nginx-1.11.2/src/http/modules/ngx_http_range_filter_module.c	2017-07-11 19:36:35.000000000 +0200
@@ -377,6 +377,10 @@
             range->start = start;
             range->end = end;

+            if (size > NGX_MAX_OFF_T_VALUE - (end - start)) {
+                return NGX_HTTP_RANGE_NOT_SATISFIABLE;
+            }
+
             size += end - start;

             if (ranges-- == 0) {
